#-------------------------#
# JenkinsFile             #
#                         #
# Created: 13.11.2021     # 
# Owner: Alex Largman     #
# Email: alex@largman.pro #
#-------------------------#
node {
    
    def commit_id
    def ECRURL  = 'https://122734987158.dkr.ecr.us-east-1.amazonaws.com/'
    def ECRCRED = 'ecr:us-east-1:ecr'
    def VERSION = '${BUILD_NUMBER}'
    def IMAGE   = 'guestbook-go'
    
    stage('Prepare') {
        git 'https://github.com/Kasper886/guest-book.git'
    }
    
    stage('Docker Build') {
        docker.withRegistry(ECRURL, ECRCRED) {
           docker.build("${IMAGE}:v${VERSION}").push()
        }
    }
}
